unit U_player;
interface
uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, U_BaseForm, Vcl.Imaging.jpeg,
  Vcl.ExtCtrls, Vcl.OleCtrls, WMPLib_TLB, Vcl.StdCtrls, Vcl.Imaging.pngimage;
type
  TF_player = class(TBaseForm)
    MediaPlayer: TWindowsMediaPlayer;
    timer: TTimer;
    painel: TPanel;
    procedure FormActivate(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure PlayerControls;

    //------------------EVENTOS---------------------------

    //PLAY
     function PlayPause(IsHover:boolean):string;
    procedure EventPlayClick(sender:TObject);
    procedure EventPlayEnter(sender:TObject);
    procedure EventPlayLeave(sender:TObject);

  private
    { Private declarations }
  public
    { Public declarations }
  end;
var
  F_player: TF_player;
  j:integer=0;
  IsPause:boolean=true;
  player:IWMPCore;

implementation
{$R *.dfm}
uses U_dm, U_Out;

//------------------------------------------------------------------------------

procedure TF_player.FormActivate(Sender: TObject);
begin
    inherited;
    mediaplayer.URL:= dm.media + dm.FilmeOption.getMP4;
    player:=mediaplayer.ControlInterface;
    timer.Enabled:=true;

    Constraints.MaxHeight :=  0;
    Constraints.MinHeight := 574;
    Constraints.MaxWidth := 0;
    Constraints.MinWidth := 1020;

    self.clientwidth:=1020;
    self.ClientHeight:=574;

    mediaplayer.Width:=clientWidth;
    mediaplayer.Height:=clientHeight;
    borderIcons:=[biSystemMenu,biMinimize];
    mediaplayer.left:=0;
    playercontrols;
end;
procedure TF_player.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  inherited;
  dm.OutOption:=1;
  Action:=TCloseAction.caNone;
  Application.CreateForm(TF_Out,F_Out);
  F_Out.ShowModal;
end;


procedure TF_player.PlayerControls;
var
imgs:TImage;
begin
  painel.Width:=clientwidth;
  painel.Height:=60;
  painel.Align:=alBottom;

  // play
  imgs:=TImage.Create(Painel);
  imgs.Parent:=painel;
  imgs.Stretch:=true;
  imgs.Width:=40;
  imgs.Height:=40;
  imgs.Picture.LoadFromFile(dm.templates+playpause(false));
  imgs.OnClick:=EventPlayClick;
  imgs.OnMouseEnter:=EventPlayEnter;
  imgs.OnMouseLeave:=EventPlayLeave;
end;

//---------------------------  EVENTOS  --------------------------------------

//-------------PLAY-----------------

procedure TF_player.EventPlayClick(sender: TObject);
begin
  if IsPause then
  begin
    IsPause:=false;
    player.controls.pause;
    (sender as TImage).Picture.LoadFromFile(dm.templates+PlayPause(true));
  end else begin
    IsPause:=true;
    player.controls.play;
    (sender as TImage).Picture.LoadFromFile(dm.templates+PlayPause(true));
  end;
end;

procedure TF_player.EventPlayEnter(sender: TObject);
begin
  (sender as TImage).Picture.LoadFromFile(dm.templates+PlayPause(true));
end;

procedure TF_player.EventPlayLeave(sender: TObject);
begin
  (sender as TImage).Picture.LoadFromFile(dm.templates+PlayPause(false));
end;

function TF_player.PlayPause(IsHover:boolean): string;
begin
  if IsPause then
  begin
    if IsHover then
      result:='painelPlayer\hover\pause.png'
    else
      result:='painelPlayer\pause.png';
  end else
  begin
    if IsHover then
      result:='painelPlayer\hover\play.png'
    else
      result:='painelPlayer\play.png';
  end;
end;

//-------------AVANCA-----------------


//-------------RETROCEDE--------------


//-------------SCREEN-----------------


//-------------CONFIG-----------------


//-------------VOLTAR-----------------


//-------------VOLUME-----------------


//------------------------------------------------------------------------------

end.


{
mediaplayer.settings.volume  // +- volume
mediaplayer.settings.mute:=true; // deixa sem som
}
